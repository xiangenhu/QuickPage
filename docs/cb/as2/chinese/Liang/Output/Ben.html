<!-- saved from url=(0013)about:internet -->
<!--
This file has been automatically generated by the Character Builder.
It can be used to test the generated SWF file(s). You can also cut and
paste from this file into your own web page. DO NOT MODIFY THIS FILE, 
as your changes may be overwritten the next time you Render to Flash.
-->
<html>
	<head>
		<script src="MSFloatingCharacter.js" type="text/javascript"></script>
		<script src="MSRSS.js" type="text/javascript"></script>
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js"></script>
	</head>
	<body onload="window.document.Movie1.focus()">

		<!--
		TO DO: Cut and paste the following to your own HTML page. Be sure to upload the entire contents of the Output directory
		into the *same* directory as your HTML page. Or, if you upload to a subdirectory, then be sure to adjust the instance(s)
		of 'Ben' below. For example, to place the Output files in a subdirectory 'Flash', replace 'Ben' with 'Flash/Ben'.
		Be sure to upload the AC_RunActiveContent.js to the same directory as your HTML page, or adjust the references.
		-->

		<div id="Movie1Div" style="position:absolute; left:0px; top:0px; width:200px; height:250px; border:0px;">

		<script src="AC_RunActiveContent.js" type="text/javascript"></script>
		<script type="text/javascript">
		if (typeof AC_FL_RunContent == 'undefined') alert("This page requires AC_RunActiveContent.js."); else 
		AC_FL_RunContent('codebase','http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=8,0,0,0',
		 'width','200','height','250','id','Movie1','name','Movie1',
		 'movie','Ben','src','Ben',
		 'quality','high','bgcolor','#ffffff','loop','false','menu','false','flashvars','',
		 'wmode','transparent',
		 'pluginspage','http://www.macromedia.com/go/getflashplayer');
		function getMovieName(movieName) {if (navigator.appName.indexOf("Microsoft") != -1) {return window[movieName]} else {return document[movieName]}}
		</script>
		<noscript>
		<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"
		 codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=8,0,0,0"
		 id=Movie1 width=200 height=250>
		    <param name=movie value="Ben.swf">
		    <param name=loop value=false>
		    <param name=menu value=false>
		    <param name=quality value=high>
		    <param name=bgcolor value=#FFFFFF>
		    <param name=wmode value=transparent>
		    <param name=flashvars value=>
		    <embed src="Ben.swf" loop=false menu=false quality=high bgcolor=#FFFFF width=200 height=250 swLiveConnect=false name=Movie1 type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/shockwave/download/index.cgi?P1_Prod_Version=ShockwaveFlash" flashvars="" wmode="transparent"></embed>
		</object>
		</noscript>

		<!-- describes a grab region for dragging the character - you can adjust left/top/width/height to create a smaller grab region. -->
		<div style="position:absolute;left:0px;top:0px;width:200px;height:250px;background-color:#008080;opacity:0.001;filter:alpha(opacity=0.1);cursor:move;" onmousedown="dragStart(event, 'Movie1Div')">
		</div>

		</div>
		<p>
		Lorem ipsum dolor sit amet consectetuer adipiscing elit suspendisse sit amet neque integer velit praesent sollicitudin eros nec sem nam placerat mollis ipsum quisque nec tortor et sem molestie tristique vivamus quis velit a nibh condimentum mattis nulla lacus augue vulputate ut placerat ac convallis nec lectus nulla facilisi suspendisse vitae enim quis neque luctus posuere morbi nibh integer nec elit. 
		Lorem ipsum dolor sit amet consectetuer adipiscing elit suspendisse sit amet neque integer velit praesent sollicitudin eros nec sem nam placerat mollis ipsum quisque nec tortor et sem molestie tristique vivamus quis velit a nibh condimentum mattis nulla lacus augue vulputate ut placerat ac convallis nec lectus nulla facilisi suspendisse vitae enim quis neque luctus posuere morbi nibh integer nec elit. 
		Lorem ipsum dolor sit amet consectetuer adipiscing elit suspendisse sit amet neque integer velit praesent sollicitudin eros nec sem nam placerat mollis ipsum quisque nec tortor et sem molestie tristique vivamus quis velit a nibh condimentum mattis nulla lacus augue vulputate ut placerat ac convallis nec lectus nulla facilisi suspendisse vitae enim quis neque luctus posuere morbi nibh integer nec elit. 
		Lorem ipsum dolor sit amet consectetuer adipiscing elit suspendisse sit amet neque integer velit praesent sollicitudin eros nec sem nam placerat mollis ipsum quisque nec tortor et sem molestie tristique vivamus quis velit a nibh condimentum mattis nulla lacus augue vulputate ut placerat ac convallis nec lectus nulla facilisi suspendisse vitae enim quis neque luctus posuere morbi nibh integer nec elit. 
		</p>
		<p/>

		<!-- Character Builder API examples -->
		<a href="javascript:getMovieName('Movie1').msRespond('hello')">msRespond('hello')</a><br>
		<a href="javascript:getMovieName('Movie1').msSpeak('This is a test of dynamic Speech')">msSpeak('This is a test of Dynamic Speech')</a><br>
		<a href="javascript:getMovieName('Movie1').msPlay('Eyenormal')">msPlay('Eyenormal')</a><br>

		<!-- Character Builder events -->
		<script type="text/javascript" language="JavaScript">

		// TODO: Replace SampleRSS.xml with your own RSS feed - see http://www.mediasemantics.com/kb/kb120.htm
		var rss = new RSSFeed('SampleRSS.xml','iPad,eye-pad,NYSE,nigh-zee');

		function onRSSSentence(text)
		{
			getMovieName('Movie1').msSpeakQueued(text);
		}
		var userid = "joeuser"; // TODO: Get this from a session cookie set by a login
		function onSceneLoaded(id)
		{
			// CB content loaded and ready to accept commands
			setTimeout(function(){rss.reloadRSSFeed()}, 250);
			$.ajax({ 
				url: "GetVars.asp?userid="+userid, data:{}, dataType:"jsonp", 
				success: function(o) { for (var name in o) { getMovieName("Movie1").msSetVariable(name, o[name]); }}, 
				error: function() { alert("Error calling server"); } 
			}); 
		}
		function onPresentingChange(id, p)
		{
			// Presenting state changed, e.g. as a result of going idle
			// if (p == "false") alert("Character idle");
		}
		function onFocusChange(id, f)
		{
			// Focus changed, e.g. as a result of navigation
		}
		function onExternalCommand(id, cmd, args)
		{
			// External Command encountered in script

			// Move a character from js using move('Movie1Div',x,y), or from CB script using an External Command action with "move" as the cmd, and "x,y" as the arg
			if (cmd == "move") move("Movie1Div", args.split(",",3)[0], args.split(",",3)[1]);
		}
		function onQueueLengthChange(id, n)
		{
			// msSpeakQueued queue length change
			if (n <= 1) rss.reloadRSSFeed();
		}
		function onVariableChange(id, n)
		{
			// One or more variables changed
			var o = {}; for (var i = 1; i <= 10; i++) o['Answer'+i] = getMovieName('Movie1').msGetVariable('Answer'+i); // REVIEW: Works for variables Answer1-Answer10 
			$.ajax({ url: "SetVars.asp?userid="+userid, type:"post", data:o, dataType:"jsonp", 
				success: function(json) {}, 
				error: function() { alert("Error calling server"); } 
			}); 
		}
		</script>

	</body>
</html>
