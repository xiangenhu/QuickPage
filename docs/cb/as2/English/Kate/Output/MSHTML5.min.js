/*
 Copyright (c) 2012-2016 Media Semantics, Inc.
 Loading spinner is copyright (c) 2011 Felix Gnass.
*/
function msEmbed(g,m,l,w,B){var M=new MSHTML5Control(g,m,l,w,B);"undefined"==typeof msEmbeddings&&(msEmbeddings=[]);msEmbeddings.push(M);for(var I=5;I<arguments.length;I+=2){var ca=arguments[I],Ia=arguments[I+1];if("Presenting"==ca||"Focus"==ca)ca="Override"+ca;M[ca]=Ia}msEventHelper(M);M.realizeTopLevel(!0).ctl=M}
function msAttach(g,m,l,w,B){var M=new MSHTML5Control(g,m,l,w,B);"undefined"==typeof msEmbeddings&&(msEmbeddings=[]);msEmbeddings.push(M);for(var I=5;I<arguments.length;I+=2)M[arguments[I]]=arguments[I+1];msEventHelper(M);M.realizeTopLevel(!1).ctl=M}
function msEventHelper(g){if(/WebKit/i.test(navigator.userAgent))var m=setInterval(function(){/loaded|complete/.test(document.readyState)&&(clearInterval(m),g.onPageLoad())},10);else{var l=onload;onload="function"!=typeof onload?function(){g.onPageLoad()}:function(){l&&l();g.onPageLoad()}}var w=onscroll;onscroll="function"!=typeof onscroll?function(){g.onScroll()}:function(){w&&w();g.onScroll()};var B;"function"!=typeof onmousemove?onmousemove=function(l){g.onMouseMove(l)}:(B=onmousemove,onmousemove=
function(l){B&&B();g.onMouseMove(l)})}
function MSHTML5Control(g,m,l,w,B){function M(){if(!Ja){var a=document.getElementById(g);qb.spin(a);Ja=!0}}function I(){Ja&&(qb.stop(),Ja=!1)}function ca(){h.Presenting=1==n.presenting&&!da;void 0!=h.OverridePresenting&&(h.Presenting=h.OverridePresenting);for(var a in n.items){h.Focus=a;break}void 0!=h.OverrideFocus&&(h.Focus=h.OverrideFocus);null==h.Focus&&h.Presenting&&(h.Presenting=!1);n.onload&&(c=h,eval(n.onload),c=null);q("Firing onSceneLoaded("+g+")");"function"==typeof onSceneLoaded&&onSceneLoaded(g);
rb();sb();Ka||F();requestAnimationFrame(Tb)}function Ia(){s="";for(var a in n.items)s+='<div id="'+g+a+'Div" style="display:none; left:0px; top:0px; position:absolute" width="'+w+'" height="'+B+'">',s+='<div id="'+g+a+'Inner" style="left:0px; top:0px; position:relative" width="'+w+'" height="'+B+'">',s+=tb(n.items[a]),Ub&&(s+='<canvas id="BubbleLayer" style="position:absolute; left:0px; top:0px;" width="'+w+'" height="'+B+'"/></canvas>'),"always"!=n.allowautoplay&&("never"==n.allowautoplay||(ya||
La||W)&&1==n.presenting&&!n.noaudio)&&(q("allowautoplay - initially presenting, have audio: putting up StartShield, Presenting now false"),s+='<canvas id="'+g+'StartShield" style="position:absolute; z-index:1000; left:0px; top:0px;" width="'+w+'" height="'+B+'" onclick="msEvent('+("'"+g+"',null,'shieldclick'")+')"/></canvas>',da=!0,h.Presenting=!1),s+="</div>",s+="</div>",s+='<div id="'+g+'Measure" style="position:absolute; visibility:hidden; width:auto; height:auto"></div>';"true"==h.Preview&&(s+=
'<div id="'+g+'PreviewDiv" style="display:none; position:absolute; left:'+(w-120)/2+"px; top:"+(B-120)/2+'px; width:120px; height:120px;"/><img src="http://www.characterhosting.com/images/MSPreview.png" border="0"></div>');document.getElementById(g+"Stage").innerHTML=s;for(var d in n.items)Vb(n.items[d]);if(a=document.getElementById("BubbleLayer")){a=a.getContext("2d");var b=d=0;for(d=0;d<10*w;d+=875)for(b=0;b<10*B;b+=875)ub||(ub={msvector:!0,data:{cx:"6120",cy:"7920",xView:"990",yView:"820",cxView:"1750",
cyView:"1750",frames:[[["fs",35,31,32,25],["bp"],["m",1391,978],["l",1478,1065],["l",1438,1105],["l",1403,1070],["l",1365,1108],["l",1398,1141],["l",1360,1179],["l",1327,1146],["l",1283,1190],["l",1321,1228],["l",1281,1268],["l",1190,1177],["l",1391,978],["c"],["f"],["bp"],["m",1621,1208],["l",1393,1383],["l",1314,1304],["l",1485,1073],["l",1540,1128],["b",1491,1190,1449,1241,1413,1282],["b",1454,1246,1492,1214,1525,1187],["l",1566,1153],["l",1621,1208],["c"],["f"],["bp"],["m",1717,1304],["l",1546,
1535],["l",1493,1482],["l",1526,1443],["l",1507,1424],["l",1468,1457],["l",1414,1403],["l",1642,1228],["l",1717,1304],["c"],["m",1560,1406],["b",1580,1381,1606,1350,1637,1314],["b",1593,1347,1562,1372,1542,1388],["l",1560,1406],["c"],["f"],["bp"],["m",1808,1395],["l",1647,1556],["l",1679,1588],["l",1639,1628],["l",1555,1544],["l",1756,1343],["l",1808,1395],["c"],["f"],["bp"],["m",1971,1559],["l",1837,1693],["b",1822,1708,1811,1718,1803,1724],["b",1796,1729,1787,1733,1775,1734],["b",1764,1736,1752,
1734,1741,1729],["b",1719,1717,1708,1706],["b",1696,1694,1687,1681,1682,1668],["b",1677,1655,1675,1643,1677,1632],["b",1679,1621,1683,1612,1689,1604],["b",1710,1581,1732,1558],["l",1851,1439],["l",1903,1491],["l",1753,1642],["b",1744,1651,1739,1657,1738,1660],["b",1737,1663,1737,1667,1740,1669],["b",1743,1672,1747,1673,1750,1671],["b",1754,1669,1760,1663,1771,1653],["l",1919,1505],["l",1971,1559],["c"],["f"],["bp"],["m",2082,1670],["l",1911,1901],["l",1858,1848],["l",1891,1809],["l",1872,1790],["l",
1833,1823],["l",1779,1769],["l",2007,1594],["l",2082,1670],["c"],["m",1925,1771],["b",1945,1746,1971,1715,2002,1679],["b",1958,1712,1927,1737,1907,1753],["l",1925,1771],["c"],["f"],["bp"],["m",2212,1800],["l",2172,1840],["l",2141,1809],["l",1980,1970],["l",1928,1918],["l",2089,1757],["l",2058,1726],["l",2098,1686],["l",2212,1800],["c"],["f"],["bp"],["m",2276,1864],["l",2075,2065],["l",2023,2013],["l",2224,1812],["l",2276,1864],["c"],["f"],["bp"],["m",2299,2122],["b",2279,2142,2264,2156,2255,2164],
["b",2235,2176,2223,2178],["b",2211,2180,2199,2179,2187,2174],["b",2175,2169,2163,2161,2152,2150],["b",2141,2139,2133,2128,2128,2116],["b",2121,2092,2123,2079],["b",2125,2067,2129,2056,2137,2047],["b",2144,2038,2158,2023,2179,2002],["l",2213,1968],["b",2233,1948,2248,1934,2257,1926],["b",2266,1919,2277,1914,2289,1912],["b",2301,1910,2313,1911,2325,1916],["b",2337,1921,2349,1929,2360,1940],["b",2371,1951,2379,1962,2384,1974],["b",2389,1986,2391,1998,2389,2011],["b",2387,2023,2383,2034,2375,2043],["b",
2368,2052,2354,2067,2333,2088],["l",2299,2122],["c"],["m",2313,2004],["b",2322,1995,2328,1988,2329,1984],["b",2331,1980,2330,1977,2327,1974],["b",2324,1971,2321,1970,2318,1971],["b",2307,1977,2297,1988],["l",2203,2082],["b",2191,2094,2185,2101,2183,2105],["b",2181,2109,2182,2112,2186,2116],["b",2190,2120,2193,2120,2198,2118],["b",2202,2116,2210,2109,2222,2097],["l",2313,2004],["c"],["f"],["bp"],["m",2553,2141],["l",2352,2342],["l",2306,2296],["l",2370,2177],["l",2279,2268],["l",2235,2224],["l",2436,
2023],["l",2480,2067],["l",2419,2187],["l",2510,2096],["l",2553,2141],["c"],["f"]]]}}),Wb(a,"",ub.data,0,d,b,.5,[])}if(a=document.getElementById(g+"StartShield"))a=a.getContext("2d"),a.fillStyle="#000000",a.globalAlpha=.5,a.fillRect(0,0,w,B),d=w/2,b=B/2,a.beginPath(),a.arc(d,b,25,0,2*Math.PI,!1),a.fillStyle="#999999",a.globalAlpha=.5,a.fill(),a.beginPath(),a.arc(d,b,27,0,2*Math.PI,!1),a.strokeStyle="#cccccc",a.lineWidth=5,a.globalAlpha=1,a.stroke(),a.beginPath(),d-=12,b-=15,a.moveTo(d,b),b+=30,a.lineTo(d,
b),b-=15,d+=30,a.lineTo(d,b),a.lineTo(d-30,b-15),a.fillStyle="#cccccc",a.globalAlpha=1,a.fill();Xb=!0;Yb&&!Ma&&(Ma=!0,ca())}function tb(a){var d="",b;for(b in a.items){var e=a.items[b];if("character"==e.type)d+=Zb(b,e);else if("image"==e.type)var f=b,v=vb(e),d=d+('<div id="'+g+f+'Div" style="position:absolute; display:'+(e.hidden?"none":"block")+"; left:"+v.x+"px; top:"+v.y+"px; width:"+v.cx+"px; height:"+v.cy+'px;"/></div>');else if("movie"==e.type)f='<div id="'+g+b+'Div" style="position:absolute; left:'+
e.left+"px; top:"+e.top+'px;">',f+='<video id="'+g+b+'Video" width="'+e.width+'" height="'+e.height+'"'+(e.autoplay?" autoplay":"")+(e.controls?" controls ":"")+">",f+='<source src="'+N(e.file)+'" type="video/mp4">',e.altfile&&(f+='<source src="'+N(e.altfile)+'" type="video/ogg">'),f+="</video></div>",d+=f;else if("text"==e.type)f=b,t="",e.face&&(t+="; font-family:"+e.face),e.size&&(t+="; font-size:"+e.size+"px"),e.color&&(t+="; color:"+e.color),v="",-1!=e.text.indexOf("<p")&&(v+="<style>p {line-height: 0%;}</style>"),
v+='<div id="'+g+f+'Div" style="position:absolute; display:'+(e.hidden?"none":"block")+"; white-space:"+(e.multiline?"wrap":"nowrap")+"; left:"+e.left+"px; top:"+e.top+"px; width:"+e.width+"px; height:"+e.height+"px"+t+'">',v+=e.text,v+="</div>",d+=v;else if("editcontrol"==e.type)var f="",f=f+('<div id="'+g+b+'EditDiv" style="display:block; z-index:999; position:absolute; left:'+e.left+"px; top:"+e.top+'px;" width="'+e.width+'" height="'+e.height+'">'),v="'"+g+"','"+b+"',",k=v+"'editchange'",f=f+
('<input id="'+g+b+'Edit" type="text" style="width:'+e.width+"px; height:"+e.height+"px; border-style:"+(1==e.border?"solid":"none")+';" onkeyup="msEvent('+k+')" onmouseup="msEvent('+k+')" onchange="msEvent('+k+')" onfocus="msEvent('+(v+"'editfocus'")+')"/>'),f=f+"</div>",d=d+f;else if("rectangle"==e.type)f="",e.wash?f+='<canvas id="'+g+b+'Wash" style="position:absolute; display:'+(e.hidden?"none":"block")+"; left:"+e.left+"px; top:"+e.top+'px;" width="'+e.width+'" height="'+e.height+'"/></canvas>':
(f+='<div id="'+g+b+'Div" style="position:absolute; display:'+(e.hidden?"none":"block")+"; left:"+e.left+"px; top:"+e.top+"px; width:"+e.width+"px; height:"+e.height+"px;",e.fillcolor&&(f+=" background-color:"+e.fillcolor+";"),0<e.strokewidth&&(f+=" border:"+e.strokewidth+"px solid "+e.strokecolor+";"),f+='"></div>'),d+=f;else if("button"==e.type)f=b,v="'"+g+"','"+f+"',",t='<a href="javascript:msEvent('+(v+"'buttonclick'")+')" onmouseover="msEvent('+(v+"'mouseover'")+')" onmouseout="msEvent('+(v+
"'mouseout'")+')" onmousedown="msEvent('+(v+"'mousedown'")+')" onmouseup="msEvent('+(v+"'mouseup'")+')"',$b(e)?e=t+=' style="display:block; position:absolute; left:'+e.left+"px; top:"+e.top+"px; width:"+e.width+"px; height:"+e.height+'px"></a>':(t+=">",v="",v+='<div id="'+g+f+'Div" style="position:absolute; left:'+e.left+"px; top:"+e.top+"px; width:"+e.width+"px; height:"+e.height+'px">',v+=t,v+='<div id="'+g+f+'Inner" style="position:relative; left:0px; top:0px; width:'+e.width+"; height:"+e.height+
'">',v+='<img id="'+g+f+'Back" style="position:absolute; left:0; top:0;" border="0"/>',e.font||(e.font="Arial"),e.text?v+='<span id="'+g+f+'Lbl" style="position:absolute; left:'+e.xfore+"px; top:"+(parseInt(e.yfore)-2)+'px;"/><font face="'+e.font+'" style="font-size:'+e.fontheight+'px" color="'+e.fontcolor+'">'+e.text+"</font></span>":e.forefile&&(v+='<img id="'+g+f+'Fore" style="position:absolute; left:'+e.xfore+"px; top:"+e.yfore+'px;" border="0"/>'),v+="</div>",v+="</a>",v+="</div>",e.over=!1,
e.down=!1,e=v),d+=e;else if("grid"==e.type)f=b,s="",s+='<div id="'+g+f+'Div" style="position:absolute; display:'+(e.hidden?"none":"block")+"; left:"+e.left+"px; top:"+e.top+"px; width:"+e.width+"; height:"+e.height+'">',s+='<div id="'+g+f+'Inner" style="position:relative; left:0px; top:0px; width:'+e.width+"; height:"+e.height+'">',s+=tb(e),s+="</div>",s+="</div>",d+=s;else if("slideshow"==e.type){v="";v+='<div id="'+g+b+'Div" style="position:absolute; left:'+e.left+"px; top:"+e.top+"px; width:"+
e.width+"; height:"+e.height+'">';v+='<div id="'+g+b+'Inner" style="position:relative; left:0px; top:0px; width:'+e.width+"; height:"+e.height+'">';f=void 0;for(f in e.items)var k="",l=e.items[f],k=k+('<div id="'+g+f+'Div" style="display:none; position:absolute; left:0px; top:0px; width:'+e.width+"; height:"+e.height+';">'),k=k+('<div id="'+g+f+'Inner" style="position:relative; left:0px; top:0px; width:'+e.width+"; height:"+e.height+';">'),k=k+tb(l),k=k+"</div>",k=k+"</div>",v=v+k;v+="</div>";v+=
"</div>";d+=v}else if("message"!=e.type&&"dialog"!=e.type){var f="component"==e.type?e["class"]:e.type,m;for(m in y)if(f==m&&(v=y[m].render(h,e))){d+=v;break}}}return d}function Zb(a,d){var b="",e="'"+g+"','"+a+"',",f=e+"'audioonloadstart'",h=e+"'audioonprogress'",l=e+"'audiooncanplaythrough'",Na=e+"'audioonerror'",m=e+"'audioonstalled'",O=e+"'audioonloadedmetadata'",r=e+"'audioonplaying'",n=e+"'audioonended'",e=e+"'audioontimeupdate'";d.narrator&&(d.left=d.top=d.width=d.height=0);var u=vb(d),b=b+
('<div id="'+g+a+'Div" style="position:absolute; left:'+u.x+"px; top:"+u.y+"px; width:"+u.cx+"; height:"+u.cy+'">'),b=b+('<canvas style="pointer-events:none;" id="'+g+a+'Canvas" width="'+u.cx+'" height="'+u.cy+'"></canvas>'),b=b+('<audio id="'+g+a+'Audio" onloadstart="msEvent('+f+')" onprogress="msEvent('+h+')" oncanplaythrough="msEvent('+l+')" onerror="msEvent('+Na+')" onstalled="msEvent('+m+')" onloadedmetadata="msEvent('+O+')" onplaying="msEvent('+r+')" onended="msEvent('+n+')" ontimeupdate="msEvent('+
e+')"/>');k[a]={idScene:d.parent.id,aImg:null,aImgShow:null,cxCharLeft:u.cxLeft,cyCharTop:u.cyTop,charCanvas:null,loadingAudio:!1,audioLoaded:!1,idMsg:null,idMsgNext:null,complete:!1,fFirstFrameAfterRec:!1,frame:0};return b+"</div>"}function vb(a){var d=0,b=parseInt(a.left),e=parseInt(a.width);0>b&&(d=-b,e+=b,b=0);b+e>w&&(e=w-b);var f=0,g=parseInt(a.top);a=parseInt(a.height);0>g&&(f=-g,a+=g,g=0);g+a>B&&(a=B-g);return{cxLeft:d,cyTop:f,x:b,y:g,cx:e,cy:a}}function ac(a,d){for(var b in a.items){var e=
a.items[b];r[b]=e;e.id=b;e.parent=a;e.hasOwnProperty("items")&&ac(e,b)}}function G(a){var d;return r[a]?a:x&&(d=Oa(r[x],a))||p&&(d=Oa(r[p],a))?d:Oa(n,a)}function Oa(a,d){for(var b in a.items){var e=a.items[b];if(e.name==d)return b;if(e=Oa(e,d))return e}return null}function K(a){try{console.log(g+": "+((new Date).getTime()-za)/1E3+"s: "+a)}catch(d){}}function q(a){if(0<Pa)try{console.log(g+": "+((new Date).getTime()-za)/1E3+"s: "+a)}catch(d){}}function wb(a){a||K("Internal Error")}function S(a,d){for(var b in d.items)if(d.items[b].type==
a)return b;return null}function xb(a,d){for(var b=d.parent;b;){if(b&&b.type==a)return b;b=b.parent}}function na(a,d){var b=xb(a,r[d]);return b?b.id:null}function yb(a,d){if(null==d)return null;var b=S(a,d);if(b){var e,b=r[b],f=null;for(e in b.items)f=b.items[e];if(e=f)return e}return null}function zb(a){var d=!1,b;for(b in a.parent.items){if(d)return a.parent.items[b];a.parent.items[b]==a&&(d=!0)}return null}function Ab(a){var d=null,b;for(b in a.parent.items){if(a.parent.items[b]==a)return d;d=a.parent.items[b]}}
function Qa(){var a=!0,d=!1;if(!T){for(var b in k)k[b].idScene==p&&(k[b].started||(d=!0),k[b].started&&!k[b].complete&&(a=!1));ha&&(a=!1);if(a){a=!1;for(b in k)k[b].idScene==p&&(d&&null!=k[b].idMsg&&null==k[b].idMsgNext||(k[b].idMsg=k[b].idMsgNext,k[b].idMsgNext=null,null==k[b].idMsg&&(a=!0)),k[b].started=!1,k[b].complete=!1);a&&(d=h.Presenting,h.Presenting=!1,0==h.Presenting&&0<P.length?(b=P.shift(),Bb(),"play"==b.type?(h.Focus=b.data,h.Presenting="true",q("Playing from queue with: "+h.Focus),F()):
"speak"==b.type&&(h.Text=b.data,h.Focus=G("Speak"),h.Presenting="true",q("Speaking from queue with: "+h.Text),F()),b=!0):b=!1,b||(d!=h.Presenting&&sb(),U(n),Aa()));requestAnimationFrame(Ra)}}}function Sa(a){var d=n,b;for(b in d.items)for(var e in d.items[b].items){var f=d.items[b].items[e];if("message"==f.type&&1==f.idle&&f.character==a)return e}return null}function N(a){return l&&a?l+"/"+a:a}function bc(a){var d=a.url;if(void 0!=a.addvariables){if(-1!=a.addvariables.indexOf("AIMLUser")){var b=new Date;
b.setTime(b.getTime()+31536E6);b.toGMTString();if(!h.AIMLUser)if(b=cc("AIMLUser"))h.AIMLUser=b,q("Returning with aimluser "+b);else{b="User";for(i=0;10>i;i++)b+=Math.floor(9*Math.random())+1;q("Creating aimluser "+b);h.AIMLUser=b;dc("AIMLUser",b,365)}if(!h.AIMLSession){b="Session";for(i=0;10>i;i++)b+=Math.floor(9*Math.random())+1;q("Creating aimlsession "+b);h.AIMLSession=b}!h.AIMLSequence&&h.AIMLSession&&(h.AIMLSequence=1);h.AIMLTimezone||(h.AIMLTimezone=(new Date).getTimezoneOffset())}var b=!1,
e;for(e in k)if(k[e].idScene==p){e=document.getElementById(g+e+"Audio");!e.canPlayType("audio/mp3")&&e.canPlayType("audio/ogg")&&(b=!0);break}d+="&genogv="+(b?"true":"false");a=a.addvariables.split(",");for(e=0;e<a.length;e++)b=h[a[e]],b=void 0==b?"":b.toString(),0<b.length&&(d+="&"+a[e]+"="+encodeURIComponent(b))}return d}function dc(a,d,b){if("function"==typeof onWriteCookie)return onWriteCookie(a,d,b);if(b){var e=new Date;e.setTime(e.getTime()+864E5*b);b="; expires="+e.toGMTString()}else b="";
document.cookie=a+"="+d+b+"; path=/"}function cc(a){if("function"==typeof onReadCookie)return onReadCookie(a);a+="=";for(var d=document.cookie.split(";"),b=0;b<d.length;b++){for(var e=d[b];" "==e.charAt(0);)e=e.substring(1,e.length);if(0==e.indexOf(a))return e.substring(a.length,e.length)}return null}function Ta(a){var d="",b=ec(l);"https://"==b.substr(0,8)?(b=b.substr(8),d=b.substr(0,b.indexOf("/"))):"http://"==b.substr(0,7)&&(b=b.substr(7),d=b.substr(0,b.indexOf("/")));b="";"https://"==a.substr(0,
8)?(b=a.substr(8),b=b.substr(0,b.indexOf("/"))):"http://"==a.substr(0,7)&&(b=a.substr(7),b=b.substr(0,b.indexOf("/")));return""!=b&&""!=d&&b!=d?(temparray=a.split(b),salt=temparray.join(d)):a}function ec(a){null==Ua&&(Ua=document.createElement("a"));Ua.href=a;return Ua.href}function Ra(){Va=!0;0<ea.length&&K("code 4");ea=[];for(var a in k)k[a].idScene==p&&ea.push(a);0<ea.length?(a=ea.pop(),fc(a)):Cb()}function fc(a){var d=k[a].idMsg,b=r[d];if(b)if(b.datafile&&!b.onframe)window["MSData_"+n.project+
d]?(b.onframe=window["MSData_"+n.project+d],Wa(a,d)):(oa=d,a=document.createElement("script"),document.getElementById(g).appendChild(a),b=N(b.datafile),a.src=b);else if(b.external)if("function"!=typeof jQuery)K("jQuery required for external messages");else if(Ba)q("Already have an outstanding server request! Ignoring.");else{Ba=a;Xa=d;var e;e=Ta(bc(b));h.AIMLSequence&&(e+="&AIMLSequence="+h.AIMLSequence,h.AIMLSequence++);e+="&callback=?";q("Calling "+e);$.ajax({url:e,data:{},dataType:"jsonp",success:function(a){for(var b in a){pa=
a[b];pa.id=b;break}Wa(Ba,Xa);Xa=Ba=null},error:function(){K("Error calling "+e);Xa=Ba=E=null;h.Presenting=!1}})}else pa=null,Wa(a,d);else E=a,Ya()}function Wa(a,d){var b=r[d],e;e=1==b.idle?b:b.external?pa:b;h.Presenting&&y.buttonset&&y.buttonset.layoutButtonSet(h,e,gc(a));var f=r[b.character];E=a;k[a].charCanvas||"replace"!=f.mode||f.width==f.artwidth||(k[a].charCanvas=document.createElement("canvas"),k[a].charCanvas.height=f.artheight,k[a].charCanvas.width=f.artwidth,k[a].cyCharTop=0,k[a].cxCharLeft=
0);C=1;Db(k[a].aImg);k[a].aImg=null;A={};e&&e.onframe&&e.onframe["0"]&&(Za=b.external?Ta(b.url):null,z=d,u=a,c=h,eval(e.onframe["0"]),Za=u=z=c=null);for(i in A);C--;0==C&&Ya()}function zc(a,d){var b=a.indexOf("cs.exe");return-1!=b?a.substr(0,b-1)+"html/"+d:null}function Eb(){C--;0>C?(K("code 3"),C=0):T&&0==C?Fb():ha&&0==C?Gb():E&&0==C&&Ya()}function fa(a){return"object"==typeof a&&a.hasOwnProperty("msvector")}function hc(){nAudio=0;for(idChar in k)k[idChar].idScene==p&&k[idChar].loadingAudio&&nAudio++;
return nAudio}function Hb(a){k[a].loadingAudio=!1;var d=hc(),b=!1;for(a in k)k[a].idMsgNext&&(b=!0);null!=T||null!=oa||0!=ea.length||null!=E||0!=d||b||Cb()}function Ya(){var a=E;E=null;k[a].aImg=A;A={};k[a].aImgShow=[];k[a].started=!1;k[a].complete=!1;k[a].fRecovering=!1;k[a].action="";k[a].fStopReached=!1;0<ea.length?(a=ea.pop(),fc(a)):0==hc()&&Cb()}function Cb(){qa=-1;E=null;I();Ka=!1;if(Ib)Ib=!1,F();else{for(idChar in k)if(k[idChar].idScene==p){var a=document.getElementById(g+idChar+"Audio");0<
a.src.length?(ic(a),Ca=0,$a=Da=(new Date).getTime()):k[idChar].frame=1}Va=!1}}function ic(a){"function"==typeof onAudioPlay?onAudioPlay():a.play()}function ab(a){"function"==typeof onAudioPause?onAudioPause():a.pause()}function Ac(a){var d;if(a)for(d=0;d<ia.length;d++)if(ia[d].src==a)return a=ia[d],ia.splice(d,1),a;return 0<ia.length?(a=ia.shift(),a.src="",a.data=null,a):new Image}function Db(a){for(var d in a)if(a[d].src){var b=a[d];b.onload=null;ia.push(b)}}function bb(a){for(var d in a.items){var b=
a.items[d];if("image"==b.type)b=N(b.file),A[d]=new Image,A[d].onload=function(){Eb()},C++,A[d].src=b;else if("button"==b.type)for(var e="backfile backoverfile backdownfile backdisabledfile backchosenfile forefile foreoverfile foredisabledfile forechosenfile".split(" "),f=0;f<e.length;f++)b[e[f]]&&(A[d+e[f]]=new Image,A[d+e[f]].onload=function(){Eb()},C++,A[d+e[f]].src=N(b[e[f]]));else"character"!=b.type||b.narrator?"grid"==b.type?bb(b):"slideshow"==b.type&&(b=b.items[x])&&bb(b):(b=Sa(d),e=r[b],cb=
1,u=d,z=b,c=h,eval(e.onframe["0"]),z=u=c=null,cb=0)}}function Fb(){wb(p==T);T=null;I();U(n);ra(p);jc(p);x&&ra(x);db(n.items[p]);Jb(p);x&&Jb(x);var a;Ea&&(a=document.getElementById(g+Ea+"Div"),a.style.display="none");a=document.getElementById(g+p+"Div");a.style.display="block";h.Preview&&(document.getElementById(g+"PreviewDiv").style.display="block");A={};x&&(a=document.getElementById(g+x+"Div"),a.style.display="block");H&&ra(H);sa=Ea=null;da||Ra()}function jc(a){a=r[a];for(var d in a.items){var b=
a.items[d];"grid"==b.type&&ra(b.id)}}function Jb(a){a=r[a];for(var d in a.items){var b=a.items[d];b.snaptoparent&&(h.setPosition(b.id,0,0),h.setSize(b.id,h.getWidth(a.parent.id),h.getHeight(a.parent.id)))}}function ra(a){if(a=r[a].onshow)c=h,eval(a),c=null}function db(a){for(var d in a.items){var b=a.items[d];if("image"==b.type){var e=document.getElementById(g+d+"Div"),f=vb(b);e.style.background="url("+N(b.file)+") -"+f.cxLeft+"px -"+f.cyTop+"px";b.tile?e.style.backgroundRepeat="repeat":e.style.backgroundSize=
b.width+"px "+b.height+"px"}else if("button"==b.type)Q(d);else if("character"==b.type&&!b.narrator){e=Sa(d);f=r[e];eb(d);k[d].aImg={};k[d].aImgShow=[];for(var v in A)e==v.substr(0,e.length)&&(k[d].aImg[v]=A[v]);u=d;z=e;c=h;eval(f.onframe["1"]);z=u=c=null;V&&Kb(d,e);"replace"==b.mode&&b.width!=b.artwidth&&(k[d].charCanvas=document.createElement("canvas"),k[d].charCanvas.height=b.artheight,k[d].charCanvas.width=b.artwidth,k[d].cyCharTop=0,k[d].cxCharLeft=0);k[d].charCanvas&&kc(d);Db(k[d].aImg);k[d].aImg=
null;k[d].aImgShow=null}else if("grid"==b.type)db(b);else if("slideshow"==b.type){var l,Na;for(Na in b.items){l=b.items[Na];break}l&&db(l)}}}function Gb(){wb(ha==x);ha=null;I();var a=r[x];db(a);var d=sa?document.getElementById(g+sa+"Div"):null,b=document.getElementById(g+x+"Div");Jb(x);ra(x);jc(x);a=a.transition;"cross"!=a||sa||(a="simple");"cross"==a?(fade={from:d,to:b,cms:500,tStart:(new Date).getTime()},Y.push(fade),fb||gb()):"simple"==a?(d&&(d.style.display="none"),lc(b,500)):(d&&(d.style.display=
"none"),b.style.display="block");A={};sa=Ea=null;Qa()}function lc(a,d){fade={from:null,to:a,cms:d,tStart:(new Date).getTime()};Y.push(fade);fb||gb()}function gb(){for(var a=(new Date).getTime(),d=!1,b=0;b<Y.length;b++){var e=Y[b].from,f=Y[b].to,g=(a-Y[b].tStart)/Y[b].cms;1>g?(e&&(e.style.display="block"),f&&(f.style.display="block"),e&&(e.style.opacity=1-g),f&&(f.style.opacity=g),d=!0):(e&&(e.style.display="none"),f&&(f.style.display="block"),Y.splice(b,1),b--)}d?requestAnimationFrame(gb):fb=!1}function $b(a){return!a.backfile&&
!a.backoverfile&&!a.backdownfile&&!a.backdisabledfile&&!a.forefile&&!a.foreoverfile&&!a.foredisabledfile&&!a.forechosenfile}function Q(a){var d=r[a];if(!$b(d)){var b="backfile",e="forefile",f=d.xfore,h=d.yfore,k=!1,l,m;d.disabled?d.hideondisabled?k=!0:(l="backdisabledfile",d[l]&&(b=l),l="foredisabledfile",d[l]&&(e=l)):d.chosen?(l="backchosenfile",m="backoverfile",d[l]?b=l:d[m]&&(b=m),l="forechosenfile",m="foredownfile",d[l]?e=l:d[m]&&(e=m)):d.over&&!d.down?(l="backoverfile",d[l]&&(b=l),l="foreoverfile",
d[l]&&(e=l)):d.over&&d.down&&(l="backdownfile",d[l]&&(b=l),l="foreoverfile",d[l]&&(e=l),f=parseInt(d.xfore)+parseInt(d.xdown),h=parseInt(d.yfore)+parseInt(d.ydown));document.getElementById(g+a+"Div").style.display=k?"none":"block";k=document.getElementById(g+a+"Back");d[b]&&(k.src=N(d[b]));if(a=document.getElementById(g+a+"Fore"))d[e]&&(a.src=N(d[e])),a.style.left=f+"px",a.style.top=h+"px"}}function ja(){var a=r[h.Focus];if(null==a)K("Invalid Focus value "+h.Focus+" - ignoring!"),h.Presenting=!1;
else if(a=a.type,"scene"==a){p=h.Focus;if(x=(hb=S("slideshow",r[p]))?Fa?Fa:S("slide",r[hb]):null)h.Focus=x,Fa=null;H=(ta=S("sequence",r[x?x:p]))?Z?Z:S("step",r[ta]):null;null!=H&&(h.Focus=H,Z=null);Aa();J&&(h.Focus=J,J=null)}else if("slide"==a){if((a=na("scene",h.Focus))&&a!=p)return Fa=h.Focus,h.Focus=a,ja();x=h.Focus;if(H=(ta=S("sequence",r[x]))?Z?Z:S("step",r[ta]):null)h.Focus=H,Z=null;Aa();J&&(h.Focus=J,J=null)}else if("step"==a){if((a=na("slide",h.Focus))&&a!=x||(a=na("scene",h.Focus))&&a!=p)return Z=
h.Focus,h.Focus=a,ja();H=h.Focus;Aa();J&&(h.Focus=J,J=null)}else if("message"==a||"dialog"==a){if((a=na("step",h.Focus))&&a!=H||(a=na("slide",h.Focus))&&a!=x||(a=na("scene",h.Focus))&&a!=p)return J=h.Focus,h.Focus=a,ja();J=h.Focus;Aa()}}function Aa(){var a=!0;for(idChar in k)if(k[idChar].idScene==p){var d=null;h.Presenting?(H?d=ib(H,idChar):x?d=ib(x,idChar):p&&(d=ib(p,idChar)),null==d?d=Sa(idChar):a=!1):d=Sa(idChar);k[idChar].idMsg?k[idChar].idMsgNext=d:k[idChar].idMsg=d}a&&(h.Presenting=!1)}function ib(a,
d){var b=r[a],e=null,f;for(f in b.items){var g=b.items[f];if("message"==g.type&&J==f||"dialog"==g.type&&J==f)return f}for(f in b.items)if(g=b.items[f],"message"==g.type&&g.character==d&&!g.idle){var k=!0;g.condition&&(c=h,k=eval(g.condition),c=null);if(k){b=h.Focus;h.Focus=f;b!=h.Focus&&rb();e=f;break}}else if("dialog"==g.type){h.Focus=f;e=ib(f,d);break}return e}function mc(){var a;return H&&(a=zb(r[H]))||x&&(a=zb(r[x]))||p&&!n.focusisland&&(a=zb(r[p]))?a.id:null}function nc(){var a;if(H&&(a=Ab(r[H])))return a.id;
if(x){a=Ab(r[x]);var d=yb("sequence",a);d&&(a=d);if(a)return a.id}return p&&!n.focusisland&&(a=Ab(r[p]),(d=yb("slideshow",a))&&(a=d),(d=yb("sequence",a))&&(a=d),a)?a.id:null}function F(){if(Ka)Ib=!0;else{Ka=!0;var a=p,d=x,b=H;for(idChar in k)if(k[idChar].idScene==p&&!h.Presenting){var e=document.getElementById(g+idChar+"Audio");e&&ab(e)}Ea=p;sa=x;Z=Fa=J=null;ja();for(idChar in k)if(k[idChar].idScene==p&&(e=k[idChar].idMsgNext,null==e&&(e=k[idChar].idMsg),e)){var e=r[e],f,v;e.external?(e=bc(e),h.AIMLSequence&&
(e+="&AIMLSequence="+h.AIMLSequence),f=Ta(e+"&MP3Prefetch=true"),v=Ta(e+"&OGVPrefetch=true")):(f=N(e.file),v=N(e.altfile));var e=idChar,l=document.getElementById(g+e+"Audio");W||ya||La||l.canPlayType("audio/mp3")||!l.canPlayType("audio/ogg")||(f=v);f?k[e].loadingAudio||(l.autoplay=!0,"function"==typeof onAudioLoad?onAudioLoad(f):(l.src=f,l.load()),ab(l),k[e].loadingAudio=!0):(l.src="",k[e].loadingAudio=!1)}if(-1!=qa)for(idChar in k)0==k[idChar].frame&&(k[idChar].frame=Math.ceil(qa*n.fps/1E3)+2);U(n);
if(p!=a){for(var m in k)k[m].idScene==a&&(Db(k[m].aImg),k[m].aImg=null,k[m].aImgShow=null,k[m].idMsg=null,k[m].idMsgNext=null);M();T=p;C=1;A={};bb(r[T]);for(var u in A);C--;0==C&&Fb()}else if(x!=d){M();wb(!T&&!ha&&!E);ha=x;C=1;A={};bb(r[x]);for(var O in A);C--;0==C&&Gb();U(n)}else H!=b&&U(n);H&&ra(H);Qa()}}function U(a){for(id in a.items)if(obj=a.items[id],"button"==obj.type){var d=obj.behavior;if(d){switch(d){case "start":obj.disabled=h.Presenting;break;case "stop":obj.disabled=!h.Presenting;break;
case "next":h.NextEnabled=null!=mc();obj.disabled=!h.NextEnabled;break;case "previous":case "first":h.PrevEnabled=null!=nc();obj.disabled=!h.PrevEnabled;break;case "pause":obj.disabled=!(h.Presenting&&!h.Paused);break;case "resume":obj.disabled=!(h.Presenting&&h.Paused);break;case "mute":obj.disabled=h.Muted;break;case "unmute":obj.disabled=!h.Muted}Q(id)}}else obj.hasOwnProperty("items")&&U(obj)}function Vb(a){for(var d in a.items){var b=a.items[d];if("rectangle"==b.type){if(b.wash){var e=document.getElementById(g+
b.id+"Wash").getContext("2d"),f=e.createLinearGradient(0,0,"horizontal"==b.wash?b.width:0,"vertical"==b.wash?b.height:0);f.addColorStop(0,b.fillcolor1);f.addColorStop(1,b.fillcolor2);e.fillStyle=f;e.fillRect(0,0,b.width,b.height)}}else"component"==b.type?y[b["class"]].init(h,b):"slideshow"!=b.type&&"slide"!=b.type&&"grid"!=b.type||Vb(b)}}function ga(a,d){q("goto"+d+" "+a);a=G(a);P=[];b=h.Focus;h.Focus=a;b!=h.Focus&&rb();var b=h.Presenting;"AndStart"==d||"AndRestart"==d?h.Presenting=!0:"AndStop"==
d&&(h.Presenting=!1);b!=h.Presenting&&sb();"AndRestart"==d&&(h.Restart=!0);h.Paused=!1;r[h.Focus]?F():K("unknown focus "+a);da&&(q("external api caused us to remove StartShield"),(b=document.getElementById(g+"StartShield"))&&b.parentNode.removeChild(b),da=!1,Ra())}function rb(){q("Firing onFocusChange("+g+","+h.Focus+")");"function"==typeof onFocusChange&&onFocusChange(g,h.Focus)}function sb(){q("Firing onPresentingChange("+g+","+h.Presenting+")");"function"==typeof onPresentingChange&&onPresentingChange(g,
h.Presenting)}function gc(a){a=xb("scene",r[a]);for(var d in a.items){var b=a.items[d];if("buttonset"==b.type)return b}return null}function Lb(a){q("nextFocus"+a);var d=mc();d?(h.Focus=d,"andStart"==a?a.Presenting=!0:"andStop"==a&&(a.Presenting=!1)):h.Presenting=!1;"always"!=n.allowautoplay&&("never"==n.allowautoplay||(ya||La||W)&&1==n.presenting&&!n.noaudio&&fInTimeline)&&(q("allowautoplay - presenting, encountered next: going Presenting false"),h.Presenting=!1);F();h.Paused=!1}function Mb(a){q("previousFocus"+
a);var d=nc();d&&(h.Focus=d,"andStart"==a?h.Presenting=!0:"andStop"==a&&(h.Presenting=!1),F());h.Paused=!1}function oc(){var a=h.Muted?0:1;for(charid in k)if(k[idChar].idScene==p){var d=document.getElementById(g+idChar+"Audio");d&&(d.volume=a)}}function jb(a){for(var d=1;2>=d;d++){var b=r[p],e=1,f;for(f in b.items){var g=b.items[f];if("message"==g.type&&g.text){if(1==a)return aa=1,g.text;if(2==a&&aa+1==e||3==a&&aa-1==e)return aa=e,g.text;if(4==a&&aa==e)return g.id;e++}}if(1==a||4==a)return"";2==a?
aa=0:3==a&&(aa=e)}aa=1;return""}function ua(a){a=G(a);return document.getElementById(g+a+"Video")}function R(a){return document.getElementById(g+a+"Div")}function eb(a){V=!1;va=wa=0;a=r[a];kb=a.width;lb=a.height}function pc(a,d){for(var b=k[a].aImgShow,e=0;e<b.length;e++)if(b[e]==d)return;b.push(d)}function xa(a){a.style.display="none";a.offsetHeight;a.style.display="inherit"}function kc(a){var d=r[a];if(k[a].charCanvas){var b=document.getElementById(g+a+"Canvas");if(b.getContext){var e=b.getContext("2d");
e.imageSmoothingEnabled=!0;e.clearRect(0,0,parseInt(d.width),parseInt(d.height));W&&xa(b);e.drawImage(k[a].charCanvas,0,0,d.artwidth,d.artheight,0,0,parseInt(d.width),parseInt(d.height))}}}function Kb(a,d){var b=k[a].charCanvas?k[a].charCanvas:document.getElementById(g+a+"Canvas");if(b.getContext){var e=b.getContext("2d");e.clearRect(0,0,b.width,b.height);W&&xa(b);for(var f=0;f<k[a].aImgShow.length;f++){var h=k[a].aImgShow[f],l=k[a].aImg[h];if(l&&(fa(l)||l.src))if(fa(l)){var m=l.n,u=l.x,O=l.y,X,n=
r[a];X=n.width/n.artwidth;var q=l.arot;if(l.morph)a:{var n=e,p=l.data,x=l.morph,w=k[a].aImg[d+l.morph].data,l=m,u=u-10*k[a].cxCharLeft,m=O-10*k[a].cyCharTop,O=X,A=q;n.fillStyle="rgba(0,0,0,100)";n.strokeStyle="rgba(0,0,0,100)";n.lineWidth=1;var B=X=q=0,C=0,z=0,y=0,G=0,H=0,I=0,J=0,F=0,E=0,M=p.frames[0],w=w.frames[0];if(M.length!=w.length)K("Tween fail - "+h+" -> "+x+" - lengths differ");else for(var D=void 0,L=void 0,p=qc(O,u/10-p.xView/10*O,m/10-p.yView/10*O,A),u=0;u<M.length;u++){D=M[u];L=w[u];if(D[0]!=
L[0]){K("Tween fail - "+h+" -> "+x+" - "+D+" vs "+L);break a}switch(D[0]){case "lw":n.lineWidth=D[1]/10*O;break;case "fs":n.fillStyle="rgba("+D[1]+","+D[2]+","+D[3]+","+D[4]/100+")";break;case "ss":n.strokeStyle="rgba("+D[1]+","+D[2]+","+D[3]+","+D[4]/100+")";break;case "bp":n.beginPath();J=I=E=xN=C=B=y=z=0;break;case "m":z=D[1];y=D[2];F=L[1];E=L[2];xA=z+(F-z)*l/100;yA=y+(E-y)*l/100;n.moveTo(p.a*xA+p.c*yA+p.e,p.b*xA+p.d*yA+p.f);break;case "l":z=D[1];y=D[2];F=L[1];E=L[2];xA=z+(F-z)*l/100;yA=y+(E-y)*
l/100;n.lineTo(p.a*xA+p.c*yA+p.e,p.b*xA+p.d*yA+p.f);break;case "b":7==D.length?(q=D[1],X=D[2],B=D[3],C=D[4],z=D[5],y=D[6]):(q=z-(B-z),X=y-(C-y),B=D[1],C=D[2],z=D[3],y=D[4]);7==L.length?(G=L[1],H=L[2],I=L[3],J=L[4],F=L[5],E=L[6]):(G=F-(I-F),H=E-(J-E),I=L[1],J=L[2],F=L[3],E=L[4]);5==D.length&&7==L.length?(G=F-(I-F),H=E-(J-E)):7==D.length&&5==L.length&&(q=z-(B-z),X=y-(C-y));x1A=q+(G-q)*l/100;y1A=X+(H-X)*l/100;x2A=B+(I-B)*l/100;y2A=C+(J-C)*l/100;xA=z+(F-z)*l/100;yA=y+(E-y)*l/100;n.bezierCurveTo(p.a*x1A+
p.c*y1A+p.e,p.b*x1A+p.d*y1A+p.f,p.a*x2A+p.c*y2A+p.e,p.b*x2A+p.d*y2A+p.f,p.a*xA+p.c*yA+p.e,p.b*xA+p.d*yA+p.f);break;case "c":n.closePath();break;case "s":n.stroke();break;case "f":n.fill()}}}else Wb(e,h,l.data,m-1,u-10*k[a].cxCharLeft,O-10*k[a].cyCharTop,X,q)}else{n=l.getAttribute("data-cyframe");m=l.getAttribute("data-n");u=l.getAttribute("data-x");O=l.getAttribute("data-y");e.drawImage(l,0,(m-1)*n,l.width,n,u-k[a].cxCharLeft,O-k[a].cyCharTop,l.width,n);for(n=1;3>=n;n++)h=l.getAttribute("data-exclude"+
n),""!=h&&(h=h.split(","),e.clearRect(h[0]-k[a].cxCharLeft,h[1]-k[a].cyCharTop,h[2],h[3]));W&&xa(b)}else K("code 5")}eb(a)}}function Wb(a,d,b,e,f,g,h,k){if(e>=b.frames.length)K("Frame out of bounds "+d+" "+e);else{a.fillStyle="rgba(0,0,0,100)";a.strokeStyle="rgba(0,0,0,100)";a.lineWidth=1.2;var l=d=0,m=0,n=0,p=0,r=0;e=b.frames[e];f=qc(h,f/10-b.xView/10*h,g/10-b.yView/10*h,k);for(g=0;g<e.length;g++)switch(b=e[g],b[0]){case "lw":a.lineWidth=1.2*b[1]/10*h;break;case "fs":a.fillStyle="rgba("+b[1]+","+
b[2]+","+b[3]+","+b[4]/100+")";break;case "ss":a.strokeStyle="rgba("+b[1]+","+b[2]+","+b[3]+","+b[4]/100+")";break;case "bp":a.beginPath();n=m=r=p=0;break;case "m":p=b[1];r=b[2];a.moveTo(f.a*p+f.c*r+f.e,f.b*p+f.d*r+f.f);break;case "l":p=b[1];r=b[2];a.lineTo(f.a*p+f.c*r+f.e,f.b*p+f.d*r+f.f);break;case "b":7==b.length?(d=b[1],l=b[2],m=b[3],n=b[4],p=b[5],r=b[6]):(d=p-(m-p),l=r-(n-r),m=b[1],n=b[2],p=b[3],r=b[4]);a.bezierCurveTo(f.a*d+f.c*l+f.e,f.b*d+f.d*l+f.f,f.a*m+f.c*n+f.e,f.b*m+f.d*n+f.f,f.a*p+f.c*
r+f.e,f.b*p+f.d*r+f.f);break;case "c":a.closePath();break;case "s":a.stroke();break;case "f":a.fill()}}}function qc(a,d,b,e){var f={a:1,b:0,c:0,d:1};f.e=d;f.f=b;f.a=f.a/10*a;f.d=f.d/10*a;for(a=0;a<e.length;a++){var g=e[a][0],h=e[a][1],k=e[a][2],l=-(h/10+b);f.e+=-(g/10+d);f.f+=l;var l=Math.cos(-k/10*3.1415926535/180),m=Math.sin(-k/10*3.1415926535/180),p=-Math.sin(-k/10*3.1415926535/180),k=Math.cos(-k/10*3.1415926535/180);f.a=l*f.a+p*f.b;f.c=l*f.c+p*f.d;f.e=l*f.e+p*f.f;f.b=m*f.a+k*f.b;f.d=m*f.c+k*f.d;
f.f=m*f.e+k*f.f;h=h/10+b;f.e+=g/10+d;f.f+=h}return f}function Cc(){var a=y.rasterctl;a&&a.ctlTrack(h,k[u],u,z,Nb,Ob)}function Tb(){if(!(h.Paused||da||T||Va)){var a=(new Date).getTime();a>$a+1E3/n.fps&&($a=a,Dc(a-Da+Ca))}h.vh&&(a=h.vh.cp.variablesManager.getVariableValue("msPlay"))&&(h.msPlay(a),h.vh.cp.variablesManager.setVariableValue("msPlay",""));try{if(parent.GetPlayer){var d=parent.GetPlayer().GetVar("msPlay");d&&(h.msPlay(d),parent.GetPlayer().SetVar("msPlay",""))}}catch(b){}requestAnimationFrame(Tb)}
function Dc(a){if(!Pb){Pb=!0;for(var d in k)if(k[d].idScene==p&&!(E&&E!=d||k[d].fStopReached)){var b=r[k[d].idMsg];if(b&&(b.external&&pa&&(b=pa),b&&b.onframe)){ka=!1;for(var e in b.onframe)if(e=parseInt(e),0!=e){var f=!1;0<k[d].frame?f=e==k[d].frame:(f=Math.floor(1E3*(e-1)/n.fps),f=f>qa&&f<=a);f&&(k[d].fFirstFrameAfterRec&&(k[d].aImgShow=[],k[d].fFirstFrameAfterRec=!1),k[d].started=!0,eb(d),u=d,z=k[d].idMsg,c=h,eval(b.onframe[e]),z=u=c=null,V&&!E&&Kb(d,b.id));if(ka)break}0<k[d].frame&&(ka||k[d].frame++);
""==k[d].action||E||(eb(d),u=d,z=k[d].idMsg,c=h,Cc(),z=u=c=null,V&&Kb(d,b.id));k[d].charCanvas&&!E&&kc(d)}if(Va)break}qa=Math.max(qa,a);Pb=!1}}function rc(a){if(a=r[a]){a.toggleschosen&&(a.chosen=!a.chosen,Q(a.id));a.stayschosen&&(a.chosen=!0,Q(a.id));if(a.resetspeers)for(var d in a.parent.items){var b=a.parent.items[d];"button"==b.type&&b!=a&&(b.chosen=!1,Q(b.id))}if(d=a.onclick)c=h,eval(d),c=null}}function sc(a){for(var d in a.items){var b=a.items[d];"button"==b.type?"enter"==b.key&&rc(b.id):"slideshow"!=
b.type&&"slide"!=b.type&&"grid"!=b.type||sc(b)}}function Qb(){"function"==typeof onVariableChange&&onVariableChange(g);tc(n)}function tc(a){for(id in a.items)obj=a.items[id],"text"==obj.type&&obj.variable?R(obj.id).children[0].innerHTML=h[obj.variable]:obj.hasOwnProperty("items")&&tc(obj)}function Bb(){q("Firing onQueueLengthChange("+g+","+P.length+")");"function"==typeof onQueueLengthChange&&onQueueLengthChange(g,P.length)}function Ec(a){if("Stop"!=ba)for(;;){var d=a[ba];if(!d){K("missing state "+
ba);break}for(var b=[],e=0;e<d.transitions.length;e++){var f=d.transitions[e];if(f[0].toLowerCase()==la.toLowerCase()||"*"==f[0]){var g=!0;f[1]&&(c=h,g=eval(f[1]),c=null);if(g){b.push(e);break}}}if(0==b.length){""!=la&&q("No transition possible for input: "+la);break}else if(q("Taking transition "+(b[0]+1)),f=d.transitions[b[0]],d=f[2],c=h,eval(d),c=null,ba=f[3],la="",-1!=d.indexOf("msSetVariable")&&Qb(),q("New state: "+ba),"Stop"==ba)break;else if(d=a[ba],d=d.actions)c=h,eval(d),c=null,-1!=d.indexOf("msSetVariable")&&
Qb()}}function mb(a,d){var b=document.createElement(a||"div"),e;for(e in d)b[e]=d[e];return b}function nb(a){for(var d=1,b=arguments.length;d<b;d++)a.appendChild(arguments[d]);return a}function Fc(a,d,b,e){var f=["opacity",d,~~(100*a),b,e].join("-");b=.01+b/e*100;e=Math.max(1-(1-a)/d*(100-b),a);var g=ob.substring(0,ob.indexOf("Animation")).toLowerCase();uc[f]||(Gc.insertRule("@"+(g&&"-"+g+"-"||"")+"keyframes "+f+"{0%{opacity:"+e+"}"+b+"%{opacity:"+a+"}"+(b+.01)+"%{opacity:1}"+(b+d)%100+"%{opacity:"+
a+"}100%{opacity:"+e+"}}",0),uc[f]=1);return f}function Ga(a,d){for(var b in d){var e=a.style,f;a:{f=b;var g=a.style,h=void 0,k=void 0;if(void 0===g[f]){f=f.charAt(0).toUpperCase()+f.slice(1);for(k=0;k<vc.length;k++)if(h=vc[k]+f,void 0!==g[h]){f=h;break a}f=void 0}}e[f||b]=d[b]}return a}function wc(a){for(var d=1;d<arguments.length;d++){var b=arguments[d],e;for(e in b)void 0===a[e]&&(a[e]=b[e])}return a}function xc(a){for(var d={x:a.offsetLeft,y:a.offsetTop};a=a.offsetParent;)d.x+=a.offsetLeft,d.y+=
a.offsetTop;return d}var h=this;this.c=null;this.idDiv=g;this.base=l;this.widthEmbed=w;this.heightEmbed=B;var n=void 0,r=null;this.Presenting=!1;this.Text=this.Focus="";this.Muted=this.Paused=!1;var Pa=2,da=!1,Xb=!1,Yb="complete"===document.readyState,Ma=!1,p=null,hb=null,x=null,ta=null,H=null,Ea=null,sa=null,J=null,Fa=null,Z=null,Va=!0,T=null,ha=null,E=null,oa=null,Ka=!1,Ib=!1,Ha=0,y={},C=0,A={},ia=[],k={},ea=[],u,z,cb=0,V,wa,va,kb,lb,qa=-1,Ca=0,Da=0,$a=0,ka=!1,Ba=null,Xa=null,pa=null,Za=null,ba,
la,P=[],Ub=!1,ub=null,Ua=null,za=(new Date).getTime(),yc=0,Y=[],fb=!1,aa=1,Rb=0,Sb=0,ma=[],Nb=0,Ob=0,ya=navigator.userAgent.match(/iPhone/i),La=navigator.userAgent.match(/iPad/i),W=navigator.userAgent.match(/android/i);navigator.userAgent.match(/AppleWebKit/i);this.realizeTopLevel=function(a){a&&document.write('<div id="'+g+'" style="top:0px; left:0px; width:'+w+"px; height:"+B+'px"></div>');a=document.getElementById(g);s="";s+='<div id="'+g+'Stage" style="position:relative" width="'+w+'" height="'+
B+'" onkeydown="msEvent('+("'"+g+"','"+g+"Stage','keydown'")+')">';s+="&nbsp;";s+="</div>";a.innerHTML=s;if(!DetectHTML5())return a;qb=(new pb({lines:11,length:7,width:4,radius:10,rotate:0,color:"#eeeeee",speed:1,trail:60,shadow:!1,hwaccel:!1,className:"spinner",zIndex:1,top:B/2-17,left:w/2-17})).spin(a);var d=document.createElement("script");a.appendChild(d);var b=N(m+".js");"true"==h.Preview&&(b+="?Preview=true");d.src=b;return a};var qb=null,Ja=!0;this.aDocLoaded=function(){if(void 0==n&&(n=window[m+
"_Dir"],void 0!=n))if("true"==n.exceeded||"true"==n.trial&&n.hostingresources&&""!=n.hostingresources)document.getElementById(g+"Stage").innerHTML='<div style="position:absolute; left:'+(w-112)/2+"px; top:"+(B-112)/2+'px; width:112px; height:87px;"/><a href="http://www.mediasemantics.com"><img src="http://www.characterhosting.com/images/MSLogo.gif" border="0"></a></div>',I();else{r={};n.type="project";n.parent=null;ac(n,"");parseInt(n.version.split(".")[3])&1&&(Ub=!0);for(var a=n.modules?n.modules.split(","):
[],d=Ha=0;d<a.length;d++){var b=a[d];if(window["MSModule_"+b])y[b]=window["MSModule_"+b];else{y[b]={loading:!0};var e=document.createElement("script");document.getElementById(g).appendChild(e);b=N("MSHTML5_"+b+".min.js");Ha++;e.src=b}}0==Ha&&Ia()}};(function(){for(var a=0,d=["ms","moz","webkit","o"],b=0;b<d.length&&!window.requestAnimationFrame;++b)window.requestAnimationFrame=window[d[b]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[d[b]+"CancelAnimationFrame"]||window[d[b]+"CancelRequestAnimationFrame"];
window.requestAnimationFrame||(window.requestAnimationFrame=function(b,d){var g=(new Date).getTime(),h=Math.max(0,16-(g-a)),k=window.setTimeout(function(){b(g+h)},h);a=g+h;return k});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)})})();this.getDirObjectFromId=function(a){return r[a]};this.debugTrace=function(a){if(1<Pa)try{console.log(g+": "+((new Date).getTime()-za)/1E3+"s: "+a)}catch(d){}};this.frameTrace=function(a){if(2<Pa&&10>((new Date).getTime()-za)/1E3)try{console.log(g+
": "+((new Date).getTime()-za)/1E3+"s: "+a)}catch(d){}};this.checkAllComplete=Qa;this.aModuleLoaded=function(){for(var a in y)if(y[a].loading){var d=window["MSModule_"+a];d&&(y[a]=d,Ha--)}0==Ha&&Ia()};this.someDataLoaded=function(){if(oa&&window["MSData_"+n.project+oa]){var a=oa;oa=null;var d=r[a];d.onframe=window["MSData_"+n.project+a];Wa(d.character,a)}};this.aVectorLoaded=function(){for(var a in A){var d=A[a];fa(d)&&null==d.data&&(d.data=window["MS"+d.digest],d.data&&C--)}T&&0==C?Fb():ha&&0==C?
Gb():E&&0==C&&Ya()};this.onAudioLoadCompleteExt=function(){for(charid in k)if(k[idChar].loadingAudio){Hb(idChar);break}};this.startPresenting=function(){q("startPresenting");h.Presenting||(r[h.Focus]?(h.Presenting=!0,h.Paused=!1,F()):K("startPresenting() - no valid messages available"))};this.restartPresenting=function(){q("restartPresenting");r[h.Focus]?(h.Presenting=!0,h.Paused=!1,F()):K("restartPresenting() - no valid messages available")};this.stopPresenting=function(){q("stopPresenting");h.Presenting&&
(h.Presenting=!1,h.Paused=!1,F())};this.pausePresenting=function(){q("pausePresenting");if(!h.Paused){yc=(new Date).getTime()-Da+Ca;for(charid in k)if(k[idChar].idScene==p){var a=document.getElementById(g+idChar+"Audio");a&&ab(a)}h.Paused=!0;U(n)}};this.resumePresenting=function(){q("resumePresenting");if(h.Paused){for(charid in k)if(k[idChar].idScene==p){var a=document.getElementById(g+idChar+"Audio");a&&ic(a)}h.Paused=!1;U(n);Ca=yc;$a=Da=(new Date).getTime()}};this.msgoto=function(a){ga(a,"")};
this.gotoAndStart=function(a){ga(a,"AndStart")};this.gotoAndStop=function(a){ga(a,"AndStop")};this.gotoAndRestart=function(a){ga(a,"AndRestart")};this.externalCommand=function(a,d){q("Firing onExternalCommand("+a+","+d+")");"function"==typeof onExternalCommand&&onExternalCommand(g,a,d);h.vh&&h.vh.cp.variablesManager.setVariableValue(a,d)};this.bubble=function(a,d){q("bubble "+a+" "+d);var b;a:{b=xb("scene",r[a]);for(var e in b.items){var f=b.items[e];if("bubble"==f.type&&(!f.target||f.target==a)){b=
f;break a}}b=null}b&&y.bubble.updateBubble(h,b,d)};this.nextFocus=function(){return Lb("")};this.nextFocusAndStart=function(){return Lb("andStart")};this.nextFocusAndStop=function(){return Lb("andStop")};this.previousFocus=function(){return Mb("")};this.previousFocusAndStart=function(){return Mb("andStart")};this.previousFocusAndStop=function(){return Mb("andStop")};this.firstFocus=function(){return firstFocusHelper("")};this.firstFocusAndStart=function(){return firstFocusHelper("andStart")};this.firstFocusAndStop=
function(){return firstFocusHelper("andStop")};this.firstFocus=function(){q("firstFocus"+s);var a;a=null;n.focusisland?null!=hb?a=S("slide",r[hb]):null!=ta&&(a=S("step",r[ta])):a=S("scene",n);a&&(h.Focus=a,"andStart"==s?h.Presenting=!0:"andStop"==s&&(h.Presenting=!1),F());h.Paused=!1};this.mute=function(){q("mute");h.Muted=!0;U(n);oc()};this.unmute=function(){q("unmute");h.Muted=!1;U(n);oc()};this.trace=function(a){console.log(a)};this.getText=function(a){return(a=document.getElementById(g+a+"Edit"))?
a.value:""};this.setText=function(a,d){var b=document.getElementById(g+a+"Edit");b&&(b.value=d)};this.daysSinceLastVisit=function(){var a=(new Date).getTime(),d=parseInt(cc("lastvisit"));dc("lastvisit",a.toString(),365);return ret=d?Math.floor((a-d)/864E5):a+31536E6};this.android=function(){return W};this.iOS=function(){return ya||La};this.firstFAQ=function(){return jb(1)};this.nextFAQ=function(){return jb(2)};this.previousFAQ=function(){return jb(3)};this.targetFAQ=function(){return jb(4)};this.show=
function(a){a=G(a);if(a=R(a))a.style.display="block"};this.hide=function(a){a=G(a);if(a=R(a))a.style.display="none"};this.fadein=function(a){a=G(a);(a=R(a))&&lc(a,500)};this.fadeout=function(a){a=G(a);if(a=R(a))fade={from:a,to:null,cms:500,tStart:(new Date).getTime()},Y.push(fade),fb||gb()};this.setPosition=function(a,d,b){d=Math.round(d);b=Math.round(b);a=G(a);var e=r[a];e&&(e.left=d,e.top=b);if(a=R(a))a.style.left=d+"px",a.style.top=b+"px"};this.setSize=function(a,d,b){d=Math.round(d);b=Math.round(b);
a=G(a);var e=r[a];e&&(e.width=d,e.height=b);var f=R(a);f&&e&&("character"==e.type?(d=k[e.id].idMsg,b=Zb(e.id,e),f.outerHTML=b,k[e.id].idMsg=d):"image"==e.type?(f.style.width=d+"px",f.style.height=b+"px",f.style.backgroundSize=d+"px "+b+"px"):"bubble"==e.type?(b=y[e.type].render(e.id,e.type,e),f.outerHTML=b):"movie"==e.type?(f.style.width=d+"px",f.style.height=b+"px",e=ua(a),e.width=d,e.height=b):(f.style.width=d+"px",f.style.height=b+"px"))};this.enable=function(a){a=G(a);r[a].disabled=!1;Q(a)};this.disable=
function(a){a=G(a);r[a].disabled=!0;Q(a)};this.getX=function(a){return(a=R(G(a)))?parseInt(a.style.left.replace("px","")):0};this.getY=function(a){return(a=R(G(a)))?parseInt(a.style.top.replace("px","")):0};this.getWidth=function(a){return(a=R(G(a)))?parseInt(a.style.width.replace("px","")):0};this.getHeight=function(a){return(a=R(G(a)))?parseInt(a.style.height.replace("px","")):0};this.stageWidth=function(){return w};this.stageHeight=function(){return B};this.max=function(a,d){return a>=d?a:d};this.min=
function(a,d){return a>=d?d:a};this.moviePlay=function(a){(a=ua(a))&&a.play()};this.movieStop=function(a){(a=ua(a))&&a.pause()};this.movieGotoAndStop=function(a,d){var b=ua(a);b&&(b.pause(),4==b.readyState&&(b.currentTime=d))};this.movieReached=function(a,d){var b=ua(a);return b?b.currentTime>=d:!1};this.movieReachedEnd=function(a){return(a=ua(a))?a.currentTime>=a.duration:!1};this.setFocus=function(a){};this.random=function(){ma.push(Math.random()*ma.pop())};this.push=function(a){ma.push(a)};this.lessthan=
function(){var a=ma.pop(),d=ma.pop();ma.push(d<a)};this.ifnot=function(a){ma.pop()||(k[u].frame=a,ka=!0)};this.branch=function(a){k[u].frame=a;ka=!0};this.button=function(a){y.buttonset&&y.buttonset.button(h,gc(u),a)};this.load=function(a,d,b,e,f,h){0!=cb&&h>cb||(a=z+a,b=Za?zc(Za,d):N(d),"js"==d.substr(d.length-2)?(A[a]={},A[a].msvector=!0,A[a].digest=d.substr(0,d.length-3),window["MS"+A[a].digest]?A[a].data=window["MS"+A[a].digest]:(A[a].data=null,a=document.createElement("script"),document.getElementById(g).appendChild(a),
C++,a.src=b)):(d=ec(b),A[a]=Ac(d),A[a].src!=d&&(A[a].onload=function(){Eb()},A[a].setAttribute("data-cyframe",f),C++,A[a].src=b)))};this.update=this.add=function(a,d,b,e){var f=0,h=0,l=1,m=[],p=[],n=k[u].aImg[z+a];if(null!=n){k[u].lastCmdAddId=a;pc(u,z+a);if(2==arguments.length)l=d,f=fa(n)?n.x:parseInt(n.getAttribute("data-x")),h=fa(n)?n.y:parseInt(n.getAttribute("data-y")),m=fa(n)&&n.arot?n.arot:[];else if(4==arguments.length)f=d,h=b,l=e,m=fa(n)&&n.arot?n.arot:[];else if(4<arguments.length)if(f=
d,h=b,l=e,0==(arguments.length-4)%4)for(var q=4;arguments.length>q;)p.push([arguments[q],arguments[q+1],arguments[q+2],arguments[q+3]]),q+=4;else if(0==(arguments.length-4)%3)for(q=4;arguments.length>q;)m.push([arguments[q],arguments[q+1],arguments[q+2]]),q+=3;"infront"==r[u].mode&&(V=!0);var w;V||(w=parseInt(n.getAttribute("data-cyframe")),f>=wa&&f<=wa+kb&&f+n.width>=wa&&f+n.width<=wa+kb&&h>=va&&h<=va+lb&&h+w>=va&&h+w<=va+lb||(V=!0));if(!V){var x=k[u].charCanvas?k[u].charCanvas:document.getElementById(g+
u+"Canvas");if(x.getContext){var y=x.getContext("2d");y.clearRect(f-k[u].cxCharLeft,h-k[u].cyCharTop,n.width,w);W&&xa(x);y.drawImage(n,0,(l-1)*w,n.width,w,f-k[u].cxCharLeft,h-k[u].cyCharTop,n.width,w);for(q=0;q<p.length;q++)y.clearRect(p[q][0]-k[u].cxCharLeft,p[q][1]-k[u].cyCharTop,p[q][2],p[q][3]);W&&xa(x)}else K("No canvas support.");wa=f;va=h;kb=n.width;lb=w}if(fa(n))n.x=f,n.y=h,n.n=l,n.arot=m,n.morph=null;else for(n.setAttribute("data-x",f),n.setAttribute("data-y",h),n.setAttribute("data-n",l),
q=0;3>q;q++)f="",q<p.length&&(f=p[q][0]+","+p[q][1]+","+p[q][2]+","+p[q][3]),n.setAttribute("data-exclude"+(q+1),f)}};this.bug_workaround=xa;this.updatetween=this.addtween=function(a,d,b,e,f){var g=0,h=0,l=0,n=[],m=k[u].aImg[z+a],p=k[u].aImg[z+d];if(m&&p){pc(u,z+a);if(3==arguments.length)l=b,g=m.x,h=m.y;else if(5<=arguments.length)for(g=b,h=e,l=f,p=5;arguments.length>p;)n.push([arguments[p],arguments[p+1],arguments[p+2]]),p+=3;m.x=g;m.y=h;m.n=l;m.arot=n;m.morph=d;V=!0}};this.rem=function(a){var d=
k[u].aImg[z+a];d&&(d.arot=[],d.morph=null);a:{a=z+a;for(var d=k[u].aImgShow,b=0;b<d.length;b++)if(d[b]==a){d.splice(b,1);break a}}V=!0};this.stop=function(){var a=!1;r[z].idle&&null==k[u].idMsgNext&&(a=!0);if(a)k[u].frame=1,ka=!0;else if(a=k[u],!a.fStopReached){a.fRecovering=!1;a.fFirstFrameAfterRec=!1;a.fStopReached=!0;a.frame=0;var d=document.getElementById(g+u+"Audio");ab(d);a.action||(a.complete=!0,Qa(u))}};this.rec=function(a){k[u].idMsgNext&&(k[u].frame=a,ka=!0,k[u].fRecovering=!0,k[u].fFirstFrameAfterRec=
!0)};this.addctl=function(a,d,b,e){var f=y.rasterctl;f&&f.addctl(h,k[u],u,z,a,d,b,e)};this.addtweenctl=function(){};this.ctlaction=function(a){var d=y.rasterctl;d&&d.ctlaction(h,k[u],u,z,a,Nb,Ob)};this.onPageLoad=function(){Yb=!0;Xb&&!Ma&&(Ma=!0,ca())};this.onMouseMove=function(a){a=a||window.event;var d=document.getElementById(g).getBoundingClientRect();Nb=a.clientX+Sb-d.left;Ob=a.clientY+Rb-d.top};this.onScroll=function(){Rb=document.body.scrollTop;Sb=document.body.scrollLeft};var Pb=!1;this.msEvent=
function(a,d,b){switch(d){case "audioonloadstart":break;case "audioonprogress":break;case "audiooncanplaythrough":k[a].loadingAudio&&Hb(a);break;case "audioonerror":d=document.getElementById(g+a+"Audio");k[a].loadingAudio&&(K("Embedded character unable to play audio - will still move lips"+("object"==typeof d.error?" - code "+d.error.code:"")),Hb(a));break;case "audioonstalled":break;case "audioonloadedmetadata":break;case "audioonplaying":break;case "audioonended":break;case "audioontimeupdate":d=
document.getElementById(g+a+"Audio");0<d.currentTime&&!k[a].fRecovering&&(Ca=Math.floor(1E3*d.currentTime),Da=(new Date).getTime());break;case "onload":onload(a);break;case "buttonclick":rc(a);break;case "mouseover":r[a].over=!0;Q(a);break;case "mouseout":r[a].over=!1;Q(a);break;case "mousedown":r[a].down=!0;Q(a);break;case "mouseup":r[a].down=!1;Q(a);break;case "editchange":d=r[a];d.variable&&(a=document.getElementById(g+a+"Edit"))&&h[d.variable]!=a.value&&(h[d.variable]=a.value,Qb());break;case "editfocus":ya&&
window.scrollTo(Sb,Rb);break;case "keydown":13==event.keyCode&&sc(r[p]);break;case "shieldclick":q("user clicked StartShield");(a=document.getElementById(g+"StartShield"))&&a.parentNode.removeChild(a);da=!1;h.startPresenting();Ra();break;default:var e=!1;if(a=r[a])for(var f in y)if(y[f].event(h,d,a,b)){e=!0;break}e||K("unhandled event "+d)}};this.msSetTraceLevel=function(a){Pa=a};this.msGoto=function(a){q("msGoto('"+a+"')");ga(a,"")};this.msGotoAndStart=function(a){q("msGotoAndStart('"+a+"')");ga(a,
"AndStart")};this.msGotoAndStop=function(a){q("msGotoAndStop('"+a+"')");ga(a,"AndStop")};this.msPlay=function(a){q("msPlay('"+a+"')");ga(a,"AndStart")};this.msPlayQueued=function(a){q("msPlayQueued('"+a+"')");h.Presenting||h.Restart?(P.push({type:"play",data:a}),Bb()):(h.Focus=G(a),h.Presenting=!0,r[h.Focus]?F():K("msPlayQueued() - no message "+a))};this.msSpeak=function(a){q("msSpeak('"+a+"')");P=[];h.Presenting=!0;h.Focus=G("Speak");h.Text=a;r[h.Focus]?F():K("msSpeak() - no external message named Speak")};
this.msSpeakQueued=function(a){q("msSpeakQueued('"+a+"')");h.Presenting||h.Restart?(P.push({type:"speak",data:a}),Bb()):(h.Text=a,h.Focus=G("Speak"),h.Presenting=!0,r[h.Focus]?F():K("msSpeakQueued() - no message named Speak"))};this.msRespond=function(a){q("msRespond('"+a+"')");P=[];h.Presenting=!0;h.Focus=G("Respond");h.Text=a;r[h.Focus]?F():K("msRespond() - no external message named Respond")};this.msStart=function(){q("msStart()");P=[];this.startPresenting()};this.msStop=function(){q("msStop()");
P=[];this.stopPresenting()};this.msNextFocusAndStop=function(){q("msNextFocusAndStop()");this.nextFocusAndStop()};this.msPreviousFocusAndStop=function(){q("msPreviousFocusAndStop()");this.previousFocusAndStop()};this.msGetVariable=function(a){return this[a]};this.msSetVariable=function(a,d){this[a]=d};this.msGetVariables=function(){var a={};for(key in this)key.substr(0,1).toUpperCase()==key.substr(0,1)&&"Presenting"!=key&&"Focus"!=key&&"Paused"!=key&&"Muted"!=key&&(a[key]=this[key]);return a};this.msSetVariables=
function(a){for(key in a)this[key]=a[key]};this.msStartShieldUp=function(){return da};this.msRunSequencer=function(a,d){d?(la=d,q("Restarting machine with: "+la)):(ba="Start",la="Ok",q("Initial state: "+ba));Ec(a)};this.onLoad=function(){this.captivate&&(h.vh=this.captivate.CPMovieHandle.getMovieProps().variablesHandle)};var vc=["webkit","Moz","ms","O"],uc={},ob,Gc=function(){var a=mb("style");nb(document.getElementsByTagName("head")[0],a);return a.sheet||a.styleSheet}(),Hc={lines:12,length:7,width:5,
radius:10,rotate:0,color:"#000",speed:1,trail:100,opacity:.25,fps:20,zIndex:2E9,className:"spinner",top:"auto",left:"auto"},pb=function d(b){if(!this.spin)return new d(b);this.opts=wc(b||{},d.defaults,Hc)};pb.defaults={};wc(pb.prototype,{spin:function(d){this.stop();var b=this,e=b.opts,f=b.el=Ga(mb(0,{className:e.className}),{position:"relative",zIndex:e.zIndex}),g=e.radius+e.length+e.width,h,k;d&&(d.appendChild(f),k=xc(d),h=xc(f),Ga(f,{left:("auto"==e.left?k.x-h.x+(d.offsetWidth>>1):e.left+g)+"px",
top:("auto"==e.top?k.y-h.y+(d.offsetHeight>>1):e.top+g)+"px"}));f.setAttribute("aria-role","progressbar");b.lines(f,b.opts);if(!ob){var l=0,n=e.fps,m=n/e.speed,p=(1-e.opacity)/(m*e.trail/100),q=m/e.lines;!function Bc(){l++;for(var d=e.lines;d;d--)b.opacity(f,e.lines-d,Math.max(1-(l+d*q)%m*p,e.opacity),e);b.timeout=b.el&&setTimeout(Bc,~~(1E3/n))}()}return b},stop:function(){var d=this.el;d&&(clearTimeout(this.timeout),d.parentNode&&d.parentNode.removeChild(d),this.el=void 0);return this},lines:function(d,
b){function e(d,e){return Ga(mb(),{position:"absolute",width:b.length+b.width+"px",height:b.width+"px",background:d,boxShadow:e,transformOrigin:"left",transform:"rotate("+~~(360/b.lines*f+b.rotate)+"deg) translate("+b.radius+"px,0)",borderRadius:(b.width>>1)+"px"})}for(var f=0,g;f<b.lines;f++)g=Ga(mb(),{position:"absolute",top:1+~(b.width/2)+"px",transform:b.hwaccel?"translate3d(0,0,0)":"",opacity:b.opacity,animation:ob&&Fc(b.opacity,b.trail,f,b.lines)+" "+1/b.speed+"s linear infinite"}),b.shadow&&
nb(g,Ga(e("#000","0 0 4px #000"),{top:"2px"})),nb(d,nb(g,e(b.color,"0 0 1px rgba(0,0,0,.1)")));return d},opacity:function(d,b,e){b<d.childNodes.length&&(d.childNodes[b].style.opacity=e)}});window.Spinner=pb}function DetectHTML5(){var g=document.createElement("audio")||!1,g=g&&"undefined"!==typeof g.canPlayType,m=document.createElement("canvas"),m=!(!m.getContext||!m.getContext("2d"));return g&&m}function msGetFlash(g){return-1!=navigator.appName.indexOf("Microsoft")?window[g]:document[g]}
function msIsFlash(g){return"[object HTMLEmbedElement]"==g.toString()||"[object HTMLObjectElement]"==g.toString()}function msIsHTML5(g){return"[object HTMLDivElement]"==g.toString()&&g.hasOwnProperty("ctl")}function msDocLoaded(){for(var g=0;g<msEmbeddings.length;g++)msEmbeddings[g].aDocLoaded()}function msDataLoaded(){for(var g=0;g<msEmbeddings.length;g++)msEmbeddings[g].someDataLoaded()}function msVectorLoaded(){for(var g=0;g<msEmbeddings.length;g++)msEmbeddings[g].aVectorLoaded()}
function msModuleLoaded(){for(var g=0;g<msEmbeddings.length;g++)msEmbeddings[g].aModuleLoaded()}function msEvent(g,m,l,w){document.getElementById(g).ctl.msEvent(m,l,w)}function msPlay(g,m){var l=document.getElementById(g);null==l&&(l=msGetFlash(g));msIsFlash(l)?l.msPlay(m):msIsHTML5(l)&&l.ctl.msPlay(m)}function msSpeak(g,m){var l=document.getElementById(g);null==l&&(l=msGetFlash(g));msIsFlash(l)?l.msSpeak(m):msIsHTML5(l)&&l.ctl.msSpeak(m)}
function msSpeakQueued(g,m){var l=document.getElementById(g);null==l&&(l=msGetFlash(g));msIsFlash(l)?msGetFlash(g).msSpeakQueued(m):msIsHTML5(l)&&l.ctl.msSpeakQueued(m)}function msRespond(g,m){var l=document.getElementById(g);null==l&&(l=msGetFlash(g));msIsFlash(l)?l.msRespond(m):msIsHTML5(l)&&l.ctl.msRespond(m)}function msStart(g){var m=document.getElementById(g);null==m&&(m=msGetFlash(g));msIsFlash(m)?m.msStart():msIsHTML5(m)&&m.ctl.msStart()}
function msStop(g){var m=document.getElementById(g);null==m&&(m=msGetFlash(g));msIsFlash(m)?m.msStop():msIsHTML5(m)&&m.ctl.msStop()}function msGetVariable(g,m){var l=document.getElementById(g);null==l&&(l=msGetFlash(g));if(msIsFlash(l))return l.msGetVariable(m);if(msIsHTML5(l))return l.ctl.msGetVariable(m)}function msSetVariable(g,m,l){var w=document.getElementById(g);null==w&&(w=msGetFlash(g));msIsFlash(w)?w.msSetVariable(m,l):msIsHTML5(w)&&w.ctl.msSetVariable(m,l)}
function msGetVariables(g){g=document.getElementById(g);return msIsHTML5(g)?g.ctl.msGetVariables():{}}function msSetVariables(g,m){var l=document.getElementById(g);msIsHTML5(l)&&l.ctl.msSetVariables(m)}function msSetTraceLevel(g,m){var l=document.getElementById(g);msIsHTML5(l)&&l.msSetTraceLevel(m)}function msPause(g,m){var l=document.getElementById(g);null==l&&(l=msGetFlash(g));msIsFlash(l)?l.msPause(m):msIsHTML5(l)&&l.ctl.pausePresenting(m)}
function msResume(g,m){var l=document.getElementById(g);null==l&&(l=msGetFlash(g));msIsFlash(l)?l.msResume(m):msIsHTML5(l)&&l.ctl.resumePresenting(m)}function msStartShieldUp(g){g=document.getElementById(g);return msIsHTML5(g)?g.ctl.msStartShieldUp():!1}function msAudioLoadComplete(g){g=document.getElementById(g);if(msIsHTML5(g))g.ctl.onAudioLoadCompleteExt()}function msRunSequencer(g,m,l){g=document.getElementById(g);msIsHTML5(g)&&g.ctl.msRunSequencer(m,l)}
function msGoto(g,m){var l=document.getElementById(g);msIsHTML5(l)&&l.ctl.msStart(m)}function msGotoAndStart(g,m){var l=document.getElementById(g);msIsHTML5(l)&&l.ctl.msGotoAndStart(m)}function msGotoAndStop(g,m){var l=document.getElementById(g);msIsHTML5(l)&&l.ctl.msGotoAndStop(m)}function msNextFocusAndStop(g,m){var l=document.getElementById(g);msIsHTML5(l)&&l.ctl.msNextFocusAndStop(m)}
function msPreviousFocusAndStop(g,m){var l=document.getElementById(g);msIsHTML5(l)&&l.ctl.msPreviousFocusAndStop(m)};